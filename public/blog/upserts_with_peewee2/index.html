<!DOCTYPE html>
<html lang="en">
<head>
	<title>Upserts With PeeWee2 | Naty Harary&#39;s Personal Website</title>
	<link rel="canonical" href="http://example.org/">
	<link rel='alternate' type='application/rss+xml' title="Naty Harary&#39;s Personal Website RSS" href='/index.xml'>
	<link rel='stylesheet' type='text/css' href='/style.css'>
	<link rel="icon" href="/favicon.ico">
	<meta name="description" content="AKA what do you do when you are missing a critical function? So, I tried to find a solution of using an external database, which cannot receive queries by any API, but rather just allows users to download itself as an excel file. In this case it was a DB containing a mapping between US ZipCodes* and US states.
This mapping changes every once in a while, and I wanted to allow users to grab a new .">
	<meta name="keywords" content="backend, database, orm, legacy">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="robots" content="index, follow">
	<meta charset="utf-8">
</head>
<body>
<main>
<header><h1 id="tag_Upserts With PeeWee2">Upserts With PeeWee2</h1></header>
<article>

<h1 id="aka-what-do-you-do-when-you-are-missing-a-critical-function">AKA what do you do when you are missing a critical function?</h1>
<p>So, I tried to find a solution of using an external database, which cannot receive queries by any API, but rather just allows users to download itself as an excel file.
In this case it was a DB containing a mapping between US ZipCodes* and US states.</p>
<p>This mapping changes every once in a while, and I wanted to allow users to grab a new .xls file and upload it to our systems.
An elegant solution to this problem was to avoid deleting the entire zipcode table, but rather upserting it, specifically aiming at replacing values upon conflict.
(I probably could&rsquo;ve just replaced the entire table but where&rsquo;s the fun in that)</p>
<p>HOWEVER
I&rsquo;ve been working with some legacy systems, some using the PeeWee2 ORM&hellip;
What&rsquo;s PeeWee?
As someone who worked with Django I never heard of it, but <a href="https://docs.peewee-orm.com/">it exists</a> and it is pretty neat!</p>
<p>But we are working with an older version which doesn&rsquo;t support upsert.</p>
<ul>
<li>I bet you didn&rsquo;t know, but ZipCodeâ„¢ is uppercased like that since it is trademarked by the United States Postal Service, and ZIP stands for &ldquo;Zip Improvement Plan&rdquo;.
Now you know.</li>
</ul>


<div id="nextprev">
<a href="/meta_pages/about/"><div id="prevart">Previous:<br>About</div></a>
</div>
<div style="clear:both" class=taglist>Related<br><a id="tag_backend" href="http://example.org/tags/backend">Backend</a> &middot; <a id="tag_database" href="http://example.org/tags/database">Database</a> &middot; <a id="tag_orm" href="http://example.org/tags/orm">Orm</a> &middot; <a id="tag_legacy" href="http://example.org/tags/legacy">Legacy</a></div>
</article>
</main>

<footer>
	<a href="http://example.org/">http://example.org/</a><br><br><a href="/index.xml"><img src="/rss.svg" style="max-height:1.5em" alt="RSS Feed" title="Subscribe via RSS for updates."></a>
</footer>

</body>
</html>
